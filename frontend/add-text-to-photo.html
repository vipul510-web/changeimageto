<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Add Text to Photo Online | Free Text Overlay Tool</title>
    <meta name="description" content="Add text to photos online for free. Choose font, size, color, and position text anywhere on your image. Drag and drop text placement. No login required." />
    <meta name="keywords" content="add text to photo, text on image, photo text overlay, image text editor, add caption to photo, text watermark" />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://www.changeimageto.com/add-text-to-photo.html" />

    <meta property="og:title" content="Add Text to Photo Online - Free Tool" />
    <meta property="og:description" content="Add customizable text to photos with font, size, color, and position controls." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.changeimageto.com/add-text-to-photo.html" />

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="preload" as="style" href="./styles.css?v=20250916-3" />
    <link rel="stylesheet" href="./styles.css?v=20250916-3" />

<!-- Google AI Overview tracking -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  if (window.location.hash.includes(":~:text")) {
    if (typeof gtag === "function") {
      gtag("event", "ai_overview", {
        anchor: window.location.hash
      });
    } else {
      const checkGtag = setInterval(() => {
        if (typeof gtag === "function") {
          clearInterval(checkGtag);
          gtag("event", "ai_overview", {
            anchor: window.location.hash
          });
        }
      }, 100);
      setTimeout(() => clearInterval(checkGtag), 10000);
    }
  }
});
</script>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-D3Q582VFCG"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-D3Q582VFCG');
</script>

<style>
  .text-editor-container {
    display: grid;
    grid-template-columns: 300px 1fr;
    gap: 24px;
    margin-top: 24px;
  }
  .text-controls {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 24px;
    height: fit-content;
    position: sticky;
    top: 24px;
  }
  .control-group {
    margin-bottom: 20px;
  }
  .control-group label {
    display: block;
    font-weight: 600;
    color: var(--fg);
    margin-bottom: 8px;
    font-size: 14px;
  }
  .control-group input[type="text"],
  .control-group input[type="number"],
  .control-group select {
    width: 100%;
    padding: 10px;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 8px;
    color: var(--fg);
    font-size: 14px;
    font-family: inherit;
  }
  .control-group input[type="range"] {
    width: 100%;
    margin: 8px 0;
  }
  .control-group input[type="color"] {
    width: 100%;
    height: 40px;
    border: 1px solid var(--border);
    border-radius: 8px;
    cursor: pointer;
  }
  .style-btn {
    transition: all 0.2s ease;
  }
  .style-btn.active {
    background: var(--accent) !important;
    color: #001633 !important;
    border-color: var(--accent) !important;
    font-weight: 600 !important;
  }
  .style-btn:hover:not(.active) {
    background: var(--border) !important;
  }
  .canvas-container {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 24px;
    position: relative;
    overflow: auto;
  }
  .canvas-wrapper {
    position: relative;
    display: inline-block;
    margin: 0 auto;
  }
  #image-canvas {
    display: block;
    max-width: 100%;
    height: auto;
    border: 1px solid var(--border);
    border-radius: 8px;
    cursor: crosshair;
  }
  .text-box-overlay {
    position: absolute;
    top: 0;
    left: 0;
    pointer-events: none;
    width: 100%;
    height: 100%;
  }
  .text-box {
    position: absolute;
    border: 2px dashed var(--accent);
    background: rgba(106, 167, 255, 0.1);
    padding: 4px;
    cursor: move;
    min-width: 50px;
    min-height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: all;
  }
  .text-box.active {
    border-color: #4f46e5;
    background: rgba(79, 70, 229, 0.15);
  }
  .text-box-content {
    color: var(--fg);
    user-select: none;
    pointer-events: none;
  }
  .action-buttons {
    display: flex;
    gap: 12px;
    margin-top: 24px;
  }
  .btn {
    flex: 1;
    padding: 12px 24px;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    border: none;
    font-size: 14px;
    transition: all 0.2s ease;
  }
  .btn-primary {
    background: var(--accent);
    color: #001633;
  }
  .btn-primary:hover {
    background: #4f46e5;
    color: white;
  }
  .btn-secondary {
    background: var(--border);
    color: var(--fg);
  }
  .btn-secondary:hover {
    background: #2a3441;
  }
  @media (max-width: 1024px) {
    .text-editor-container {
      grid-template-columns: 1fr;
    }
    .text-controls {
      position: static;
    }
  }
</style>
  </head>
  <body>
    <header class="container header">
      <a href="/" class="logo-link"><img src="./logo.png?v=20250916-2" alt="ChangeImageTo" class="logo-img" /></a>
      <div style="display:flex;align-items:center;gap:16px;justify-content:space-between;width:100%">
        <h1 style="margin:0">Add Text to Photo Online - Free</h1>
        <nav class="top-nav"><a href="/blog" aria-label="Read our blog">Blog</a></nav>
      </div>
      <p>Add customizable text to your photos. Choose font, size, color, and drag text anywhere on your image. Free, no login required.</p>
    </header>

    <main class="container main">
      <form id="upload-form">
        <div class="uploader" id="dropzone">
          <input type="file" id="file-input" accept="image/*" />
          <div class="uploader-instructions">
            <strong>Drop image here</strong>
            <span>or click to browse</span>
          </div>
        </div>
      </form>

      <div id="editor-section" style="display: none;">
        <div class="text-editor-container">
          <div class="text-controls">
            <div class="control-group">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                <label for="text-input" style="margin: 0;">Text Layers</label>
                <button type="button" id="add-text-btn" style="padding: 6px 12px; background: var(--accent); color: #001633; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 12px;">+ Add Text</button>
              </div>
              <div id="text-layers-list" style="margin-bottom: 12px; max-height: 150px; overflow-y: auto; border: 1px solid var(--border); border-radius: 8px; padding: 8px;">
                <!-- Text layers will be listed here -->
              </div>
              <div style="position: relative;">
                <input type="text" id="text-input" placeholder="Enter your text here" value="Sample Text" style="padding-right: 45px;" />
                <button type="button" id="emoji-button" style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%); background: transparent; border: none; font-size: 24px; cursor: pointer; padding: 4px 8px; border-radius: 4px; transition: background 0.2s;" onmouseover="this.style.background='var(--border)'" onmouseout="this.style.background='transparent'">ðŸ˜€</button>
              </div>
              <div id="emoji-picker" style="display: none; margin-top: 12px; padding: 16px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; max-height: 300px; overflow-y: auto;">
                <div id="emoji-grid" style="display: grid; grid-template-columns: repeat(8, 1fr); gap: 8px;"></div>
              </div>
            </div>

            <div class="control-group">
              <label for="font-family">Font</label>
              <select id="font-family">
                <option value="Arial">Arial</option>
                <option value="Helvetica">Helvetica</option>
                <option value="Times New Roman">Times New Roman</option>
                <option value="Courier New">Courier New</option>
                <option value="Verdana">Verdana</option>
                <option value="Georgia">Georgia</option>
                <option value="Palatino">Palatino</option>
                <option value="Garamond">Garamond</option>
                <option value="Comic Sans MS">Comic Sans MS</option>
                <option value="Impact">Impact</option>
                <option value="Trebuchet MS">Trebuchet MS</option>
                <option value="Lucida Console">Lucida Console</option>
              </select>
            </div>

            <div class="control-group">
              <label for="font-size">Font Size (px)</label>
              <input type="number" id="font-size" min="1" value="32" style="width: 100%;" />
            </div>

            <div class="control-group">
              <label for="text-color">Text Color</label>
              <input type="color" id="text-color" value="#ffffff" />
            </div>

            <div class="control-group">
              <label>Text Style</label>
              <div style="display: flex; gap: 8px; margin-top: 8px;">
                <button type="button" id="bold-btn" class="style-btn" style="flex: 1; padding: 10px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; color: var(--fg); cursor: pointer; font-weight: 400; transition: all 0.2s;">B</button>
                <button type="button" id="underline-btn" class="style-btn" style="flex: 1; padding: 10px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; color: var(--fg); cursor: pointer; text-decoration: underline; transition: all 0.2s;">U</button>
              </div>
            </div>
            
            <div class="control-group">
              <label for="text-url">Hyperlink URL (optional)</label>
              <input type="url" id="text-url" placeholder="https://example.com" style="width: 100%;" />
              <small style="color: var(--muted); font-size: 0.85rem; margin-top: 4px; display: block;">Note: Hyperlinks work in PDF exports. PNG images don't support clickable links.</small>
            </div>
            
            <div class="control-group">
              <label for="text-rotation">Rotation Angle (degrees)</label>
              <input type="number" id="text-rotation" min="-360" max="360" value="0" step="1" style="width: 100%;" />
            </div>


            <div class="action-buttons">
              <button type="button" class="btn btn-primary" id="download-btn">Download Image</button>
              <button type="button" class="btn btn-secondary" id="reset-btn">Reset</button>
            </div>
          </div>

          <div class="canvas-container">
            <div class="canvas-wrapper" id="canvas-wrapper">
              <canvas id="image-canvas"></canvas>
              <div id="rotation-handle" style="display: none; position: absolute; width: 20px; height: 20px; background: var(--accent); border: 2px solid white; border-radius: 50%; cursor: grab; z-index: 1000; box-shadow: 0 2px 8px rgba(0,0,0,0.3);"></div>
            </div>
          </div>
        </div>
      </div>

      <section class="seo" style="margin-top: 40px;">
        <h2>How to add text to a photo</h2>
        <ol>
          <li><strong>Upload your image:</strong> Click or drag and drop your photo into the upload area above.</li>
          <li><strong>Enter your text:</strong> Type the text you want to add in the text input field.</li>
          <li><strong>Customize appearance:</strong> Choose your preferred font, enter any font size (no limits), and select a color.</li>
          <li><strong>Style your text:</strong> Click the Bold (B) or Underline (U) buttons to toggle styling, and add emojis if desired.</li>
          <li><strong>Add hyperlink (optional):</strong> Enter a URL to make your text a hyperlink (works in PDF exports).</li>
          <li><strong>Rotate text:</strong> Adjust the rotation angle to rotate your text box.</li>
          <li><strong>Position text:</strong> Click and drag the text box to place it anywhere on your image.</li>
          <li><strong>Download:</strong> Click "Download Image" to save your photo with text overlay.</li>
        </ol>

        <h3>Features</h3>
        <ul>
          <li><strong>Multiple Fonts:</strong> Choose from 12+ popular fonts including Arial, Times New Roman, Impact, and more.</li>
          <li><strong>Unlimited Font Size:</strong> Enter any font size you want - no limits! Make text as big or small as needed.</li>
          <li><strong>Text Rotation:</strong> Rotate your text at any angle from -360Â° to 360Â° for creative designs.</li>
          <li><strong>Hyperlink Support:</strong> Add URLs to your text for clickable links (works in PDF exports).</li>
          <li><strong>Color Picker:</strong> Select any color for your text using the color picker tool.</li>
          <li><strong>Text Styling:</strong> Make text bold or underlined for emphasis.</li>
          <li><strong>Emoji Support:</strong> Add emojis to your text for fun and expressive captions.</li>
          <li><strong>Drag & Drop Positioning:</strong> Click and drag text anywhere on your image for perfect placement.</li>
          <li><strong>Free & No Watermarks:</strong> All features are completely free with no watermarks on your images.</li>
        </ul>

        <h3>Use cases</h3>
        <ul>
          <li><strong>Social Media:</strong> Add captions, quotes, or watermarks to photos for Instagram, Facebook, or Twitter.</li>
          <li><strong>Memes:</strong> Create memes by adding funny text to images.</li>
          <li><strong>Marketing:</strong> Add promotional text, prices, or call-to-action messages to product photos.</li>
          <li><strong>Personal Projects:</strong> Add dates, names, or messages to personal photos and memories.</li>
          <li><strong>Presentations:</strong> Add labels, titles, or annotations to images for presentations.</li>
          <li><strong>Watermarking:</strong> Add your name or logo text to protect your images.</li>
        </ul>

        <h3>Related tools</h3>
        <p>Looking for other text-related tools? Try these:</p>
        <ul>
          <li><a href="/edit-text-in-image.html">Edit Text in Image</a> - Change existing text in images using AI</li>
          <li><a href="/remove-text-from-image.html">Remove Text from Image</a> - Remove unwanted text and watermarks</li>
          <li><a href="/convert-image-to-text.html">Convert Image to Text</a> - Extract text from images using OCR</li>
          <li><a href="/enhance-image.html">Enhance Image</a> - Improve image quality before adding text</li>
        </ul>
      </section>
    </main>

    <!-- FAQ Section -->
    <section class="container faq-section" style="margin-top: 40px; padding: 40px 0;">
      <h2>Frequently Asked Questions</h2>
      <div class="faq-list" style="margin-top: 20px;">
        <div class="faq-item" style="margin-bottom: 20px;">
          <h3>How do I add text to a photo?</h3>
          <p>Upload your image, enter your text in the text field, customize the font, size, and color, then drag the text box to position it on your image. Click "Download Image" to save your photo with text overlay.</p>
        </div>
        <div class="faq-item" style="margin-bottom: 20px;">
          <h3>Can I move the text after placing it?</h3>
          <p>Yes! Simply click and drag the text box to move it anywhere on your image. The text box will be highlighted when selected.</p>
        </div>
        <div class="faq-item" style="margin-bottom: 20px;">
          <h3>What fonts are available?</h3>
          <p>We offer 12+ popular fonts including Arial, Helvetica, Times New Roman, Courier New, Verdana, Georgia, Impact, Comic Sans MS, and more.</p>
        </div>
        <div class="faq-item" style="margin-bottom: 20px;">
          <h3>Can I add emojis to my text?</h3>
          <p>Yes! Click the "Add Emoji" button to open an emoji picker and add emojis to your text.</p>
        </div>
        <div class="faq-item" style="margin-bottom: 20px;">
          <h3>Is the text overlay tool free to use?</h3>
          <p>Yes, our text overlay tool is completely free to use. No registration, no watermarks, and no hidden fees.</p>
        </div>
        <div class="faq-item" style="margin-bottom: 20px;">
          <h3>What image formats are supported?</h3>
          <p>We support all major image formats including JPG, PNG, and other common formats. The downloaded image will be in PNG format to preserve quality.</p>
        </div>
      </div>
    </section>

    <nav class="seo-links">
      <a href="/remove-background-from-image.html">Remove Background from Image</a>
      <a href="/change-color-of-image.html">Change color of image online</a>
      <a href="/change-image-background.html">Change image background</a>
      <a href="/edit-text-in-image.html">Edit Text in Image</a>
      <a href="/remove-text-from-image.html">Remove Text from Image</a>
      <a href="/convert-image-format.html">Convert image format</a>
      <a href="/upscale-image.html">AI Image Upscaler</a>
      <a href="/enhance-image.html">Enhance Image</a>
    </nav>

    <footer class="comprehensive-footer">
      <div class="container">
        <div class="footer-grid">
          <!-- Brand Section -->
          <div class="footer-brand">
            <div class="footer-logo">
              <img src="/logo.png?v=20250921-1" alt="ChangeImageTo" style="height: 32px; margin-bottom: 16px;">
            </div>
            <p class="footer-description">
              The leading platform for free online image editing. Remove backgrounds, change colors, resize images, and enhance photos instantly with AI-powered tools.
            </p>
            <div class="footer-social">
              <a href="https://x.com/vipulawl" aria-label="Follow us on Twitter" class="social-link">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                </svg>
              </a>
              <a href="https://www.youtube.com/@changeimageto" aria-label="Subscribe on YouTube" class="social-link">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
                </svg>
              </a>
              <a href="https://linkedin.com/company/make-a-video/" aria-label="Connect on LinkedIn" class="social-link">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                </svg>
              </a>
            </div>
          </div>

          <!-- Tools Section -->
          <div class="footer-section">
            <h3 class="footer-heading">Image Tools</h3>
            <ul class="footer-links">
              <li><a href="/remove-background-from-image.html">Remove Background</a></li>
              <li><a href="/change-image-background.html">Change Background</a></li>
              <li><a href="/change-color-of-image.html">Change Image Colors</a></li>
              <li><a href="/upscale-image.html">Upscale Image</a></li>
              <li><a href="/enhance-image.html">Enhance Image</a></li>
              <li><a href="/blur-background.html">Blur Background</a></li>
              <li><a href="/add-text-to-photo.html">Add Text to Photo</a></li>
              <li><a href="/convert-image-format.html">Convert Image Format</a></li>
              <li><a href="/remove-people-from-photo.html">Remove People / Objects</a></li>
              <li><a href="/remove-text-from-image.html">Remove Text / Watermark</a></li>
              <li><a href="/remove-gemini-watermark.html">Remove Gemini Watermark</a></li>
              <li><a href="/bulk-image-resizer.html">Bulk Image Resizer</a></li>
              <li><a href="/image-quality-checker.html">Image Quality Checker</a></li>
              <li><a href="/compress-image-online.html">Compress Image</a></li>
            </ul>
          </div>

          <!-- Blog Section -->
          <div class="footer-section">
            <h3 class="footer-heading">Latest Blog Posts</h3>
            <ul class="footer-links">
              <li><a href="/blog/remove-background-from-image.html">Remove Background from Image</a></li>
              <li><a href="/blog/upscale-image.html">Upscale Image Quality</a></li>
              <li><a href="/blog/change-image-background-color.html">Change Image Background Color</a></li>
              <li><a href="/blog/remove-background-from-image-photoshop.html">Remove Background in Photoshop</a></li>
              <li><a href="/blog/change-image-background-color-online.html">Change Background Color Online</a></li>
              <li><a href="/blog/remove-background-from-image-canva.html">Remove Background in Canva</a></li>
              <li><a href="/blog/change-image-background-color-photoshop.html">Change Background in Photoshop</a></li>
              <li><a href="/blog/remove-background-from-image-android.html">Remove Background on Android</a></li>
            </ul>
          </div>

          <!-- Alternatives Section -->
          <div class="footer-section">
            <h3 class="footer-heading">Tool Alternatives</h3>
            <ul class="footer-links">
              <li><a href="/blog/photopea-vs-canva.html">Photopea vs Canva</a></li>
              <li><a href="/blog/capcut-vs-davinci-resolve.html">CapCut vs DaVinci Resolve</a></li>
              <li><a href="/blog/canva-vs-photopea.html">Canva vs Photopea</a></li>
              <li><a href="/blog/free-photoshop-alternatives.html">Free Photoshop Alternatives</a></li>
              <li><a href="/blog/ai-background-removers.html">AI Background Removers</a></li>
            </ul>
          </div>

          <!-- Company Section -->
          <div class="footer-section">
            <h3 class="footer-heading">Company</h3>
            <ul class="footer-links">
              <li><a href="/privacy-policy.html">Privacy Policy</a></li>
              <li><a href="/contact.html">Contact Us</a></li>
              <li><a href="/about.html">About</a></li>
            </ul>
          </div>
        </div>

        <!-- Bottom Bar -->
        <div class="footer-bottom">
          <div class="footer-bottom-content">
            <p class="footer-copyright">
              Â© 2024 ChangeImageTo.com. All rights reserved. Built for speed and quality.
            </p>
            <div class="footer-bottom-links">
              <a href="/privacy-policy.html">Privacy</a>
              <a href="#terms">Terms</a>
              <a href="#cookies">Cookies</a>
              <a href="#security">Security</a>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <script src="./script.js?v=20251220-1" defer></script>
    <script>
      (function() {
        const dropzone = document.getElementById('dropzone');
        const fileInput = document.getElementById('file-input');
        const editorSection = document.getElementById('editor-section');
        const canvas = document.getElementById('image-canvas');
        const ctx = canvas.getContext('2d');
        const canvasWrapper = document.getElementById('canvas-wrapper');
        
        const textInput = document.getElementById('text-input');
        const fontFamily = document.getElementById('font-family');
        const fontSize = document.getElementById('font-size');
        const textColor = document.getElementById('text-color');
        const boldBtn = document.getElementById('bold-btn');
        const underlineBtn = document.getElementById('underline-btn');
        const textUrl = document.getElementById('text-url');
        const textRotation = document.getElementById('text-rotation');
        const emojiButton = document.getElementById('emoji-button');
        const emojiPicker = document.getElementById('emoji-picker');
        const emojiGrid = document.getElementById('emoji-grid');
        const addTextBtn = document.getElementById('add-text-btn');
        const textLayersList = document.getElementById('text-layers-list');
        const downloadBtn = document.getElementById('download-btn');
        const resetBtn = document.getElementById('reset-btn');
        
        let currentImage = null;
        let imageObj = null;
        let isDragging = false;
        let isRotating = false;
        let dragOffset = { x: 0, y: 0 };
        let textLayers = [];
        let selectedLayerIndex = -1;
        const rotationHandle = document.getElementById('rotation-handle');
        
        // Text layer structure: { text, font, size, color, x, y, rotation, bold, underline, url, id }
        
        // Emoji picker (common emojis)
        const commonEmojis = ['ðŸ˜€', 'ðŸ˜ƒ', 'ðŸ˜„', 'ðŸ˜', 'ðŸ˜†', 'ðŸ˜…', 'ðŸ˜‚', 'ðŸ¤£', 'ðŸ˜Š', 'ðŸ˜‡', 'ðŸ™‚', 'ðŸ™ƒ', 'ðŸ˜‰', 'ðŸ˜Œ', 'ðŸ˜', 'ðŸ¥°', 'ðŸ˜˜', 'ðŸ˜—', 'ðŸ˜™', 'ðŸ˜š', 'ðŸ˜‹', 'ðŸ˜›', 'ðŸ˜', 'ðŸ˜œ', 'ðŸ¤ª', 'ðŸ¤¨', 'ðŸ§', 'ðŸ¤“', 'ðŸ˜Ž', 'ðŸ¤©', 'ðŸ¥³', 'ðŸ˜', 'ðŸ˜’', 'ðŸ˜ž', 'ðŸ˜”', 'ðŸ˜Ÿ', 'ðŸ˜•', 'ðŸ™', 'ðŸ˜£', 'ðŸ˜–', 'ðŸ˜«', 'ðŸ˜©', 'ðŸ¥º', 'ðŸ˜¢', 'ðŸ˜­', 'ðŸ˜¤', 'ðŸ˜ ', 'ðŸ˜¡', 'ðŸ¤¬', 'ðŸ¤¯', 'ðŸ˜³', 'ðŸ¥µ', 'ðŸ¥¶', 'ðŸ˜±', 'ðŸ˜¨', 'ðŸ˜°', 'ðŸ˜¥', 'ðŸ˜“', 'ðŸ¤—', 'ðŸ¤”', 'ðŸ¤­', 'ðŸ¤«', 'ðŸ¤¥', 'ðŸ˜¶', 'ðŸ˜', 'ðŸ˜‘', 'ðŸ˜¬', 'ðŸ™„', 'ðŸ˜¯', 'ðŸ˜¦', 'ðŸ˜§', 'ðŸ˜®', 'ðŸ˜²', 'ðŸ¥±', 'ðŸ˜´', 'ðŸ¤¤', 'ðŸ˜ª', 'ðŸ˜µ', 'ðŸ¤', 'ðŸ¥´', 'ðŸ¤¢', 'ðŸ¤®', 'ðŸ¤§', 'ðŸ˜·', 'ðŸ¤’', 'ðŸ¤•', 'ðŸ¤‘', 'ðŸ¤ ', 'ðŸ˜ˆ', 'ðŸ‘¿', 'ðŸ‘¹', 'ðŸ‘º', 'ðŸ¤¡', 'ðŸ’©', 'ðŸ‘»', 'ðŸ’€', 'â˜ ï¸', 'ðŸ‘½', 'ðŸ‘¾', 'ðŸ¤–', 'ðŸŽƒ', 'ðŸ˜º', 'ðŸ˜¸', 'ðŸ˜¹', 'ðŸ˜»', 'ðŸ˜¼', 'ðŸ˜½', 'ðŸ™€', 'ðŸ˜¿', 'ðŸ˜¾'];
        
        // Initialize emoji grid
        function initEmojiPicker() {
          if (!emojiGrid) return;
          emojiGrid.innerHTML = '';
          commonEmojis.forEach(emoji => {
            const btn = document.createElement('button');
            btn.textContent = emoji;
            btn.type = 'button';
            btn.style.cssText = 'font-size:24px;padding:8px;background:var(--bg);border:1px solid var(--border);border-radius:6px;cursor:pointer;transition:all 0.2s;';
            btn.onmouseover = () => btn.style.background = 'var(--accent)';
            btn.onmouseout = () => btn.style.background = 'var(--bg)';
            btn.onclick = () => {
              if (selectedLayerIndex >= 0 && selectedLayerIndex < textLayers.length) {
                textInput.value += emoji;
                updateText();
              }
            };
            emojiGrid.appendChild(btn);
          });
        }
        
        function toggleEmojiPicker() {
          if (!emojiPicker) return;
          const isVisible = emojiPicker.style.display !== 'none';
          emojiPicker.style.display = isVisible ? 'none' : 'block';
        }
        
        // Initialize emoji picker on load
        initEmojiPicker();
        
        function loadImage(file) {
          const reader = new FileReader();
          reader.onload = (e) => {
            imageObj = new Image();
            imageObj.onload = () => {
              // Set canvas size to image size
              canvas.width = imageObj.width;
              canvas.height = imageObj.height;
              
              // Draw image on canvas
              ctx.drawImage(imageObj, 0, 0);
              
              // Show editor
              editorSection.style.display = 'block';
              
              // Initialize with one text layer
              if (textLayers.length === 0) {
                textLayers.push({
                  id: Date.now(),
                  text: 'Sample Text',
                  font: 'Arial',
                  size: 32,
                  color: '#ffffff',
                  x: canvas.width / 2,
                  y: canvas.height / 2,
                  rotation: 0,
                  bold: false,
                  underline: false,
                  url: ''
                });
                selectLayer(0);
                updateTextLayersList();
              }
              
              // Draw initial text
              renderAllText();
              
              // Scroll to editor
              editorSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            };
            imageObj.src = e.target.result;
          };
          reader.readAsDataURL(file);
        }
        
        function updateText() {
          if (!imageObj) return;
          
          // Update selected layer if one is selected
          if (selectedLayerIndex >= 0 && selectedLayerIndex < textLayers.length) {
            const layer = textLayers[selectedLayerIndex];
            layer.text = textInput.value || 'Sample Text';
            layer.font = fontFamily.value;
            layer.size = Math.max(1, parseInt(fontSize.value) || 32);
            layer.color = textColor.value;
            layer.rotation = parseFloat(textRotation.value) || 0;
            layer.bold = isBold;
            layer.underline = isUnderline;
            layer.url = textUrl.value;
          }
          
          renderAllText();
        }
        
        function renderAllText() {
          if (!imageObj) return;
          
          // Redraw image
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          ctx.drawImage(imageObj, 0, 0);
          
          // Render all text layers
          textLayers.forEach((layer, index) => {
            const text = layer.text || 'Sample Text';
            const size = layer.size || 32;
            const color = layer.color || '#ffffff';
            const font = layer.font || 'Arial';
            const bold = layer.bold ? 'bold ' : '';
            const rotation = layer.rotation || 0;
            const x = layer.x || canvas.width / 2;
            const y = layer.y || canvas.height / 2;
            
            // Set font
            ctx.font = `${bold}${size}px ${font}`;
            ctx.fillStyle = color;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            
            // Measure text
            const metrics = ctx.measureText(text);
            const textWidth = metrics.width;
            const textHeight = size;
            
            // Save context
            ctx.save();
            
            // Apply rotation
            ctx.translate(x, y);
            ctx.rotate((rotation * Math.PI) / 180);
            
            // Draw text
            ctx.fillText(text, 0, 0);
            
            // Draw underline if needed
            if (layer.underline) {
              ctx.strokeStyle = color;
              ctx.lineWidth = 2;
              ctx.beginPath();
              ctx.moveTo(-textWidth / 2, textHeight / 2 + 4);
              ctx.lineTo(textWidth / 2, textHeight / 2 + 4);
              ctx.stroke();
            }
            
            // Restore context
            ctx.restore();
          });
          
          // Update rotation handle position for selected layer
          updateRotationHandle();
        }
        
        function updateRotationHandle() {
          if (!rotationHandle || selectedLayerIndex < 0 || selectedLayerIndex >= textLayers.length) {
            if (rotationHandle) rotationHandle.style.display = 'none';
            return;
          }
          
          const layer = textLayers[selectedLayerIndex];
          const canvasRect = canvas.getBoundingClientRect();
          const wrapperRect = canvasWrapper.getBoundingClientRect();
          const scaleX = canvasRect.width / canvas.width;
          const scaleY = canvasRect.height / canvas.height;
          
          // Calculate text dimensions
          ctx.font = `${layer.bold ? 'bold ' : ''}${layer.size}px ${layer.font}`;
          const metrics = ctx.measureText(layer.text || 'Sample Text');
          const textHeight = layer.size || 32;
          
          // Position handle above the text (at a distance)
          const handleDistance = Math.max(textHeight / 2 + 30, 40); // At least 40px above text
          const rotationRad = (layer.rotation * Math.PI) / 180;
          
          // Calculate handle position in canvas coordinates
          const handleX = layer.x;
          const handleY = layer.y - handleDistance;
          
          // Rotate the handle position around text center
          const rotatedX = layer.x + (handleX - layer.x) * Math.cos(rotationRad) - (handleY - layer.y) * Math.sin(rotationRad);
          const rotatedY = layer.y + (handleX - layer.x) * Math.sin(rotationRad) + (handleY - layer.y) * Math.cos(rotationRad);
          
          // Convert to screen coordinates
          const screenX = (rotatedX * scaleX) + (canvasRect.left - wrapperRect.left);
          const screenY = (rotatedY * scaleY) + (canvasRect.top - wrapperRect.top);
          
          rotationHandle.style.left = (screenX - 10) + 'px';
          rotationHandle.style.top = (screenY - 10) + 'px';
          rotationHandle.style.display = 'block';
        }
        
        function addNewTextLayer() {
          const newLayer = {
            id: Date.now(),
            text: 'Sample Text',
            font: 'Arial',
            size: 32,
            color: '#ffffff',
            x: canvas.width / 2,
            y: canvas.height / 2,
            rotation: 0,
            bold: false,
            underline: false,
            url: ''
          };
          textLayers.push(newLayer);
          selectLayer(textLayers.length - 1);
          updateTextLayersList();
          renderAllText();
        }
        
        function selectLayer(index) {
          selectedLayerIndex = index;
          if (index >= 0 && index < textLayers.length) {
            const layer = textLayers[index];
            textInput.value = layer.text;
            fontFamily.value = layer.font;
            fontSize.value = layer.size;
            textColor.value = layer.color;
            textRotation.value = layer.rotation;
            textUrl.value = layer.url || '';
            isBold = layer.bold;
            isUnderline = layer.underline;
            if (boldBtn) boldBtn.classList.toggle('active', isBold);
            if (underlineBtn) underlineBtn.classList.toggle('active', isUnderline);
          }
          updateTextLayersList();
          updateRotationHandle();
        }
        
        function deleteLayer(index) {
          if (textLayers.length <= 1) {
            // Don't allow deleting the last layer, just reset it
            textLayers[0] = {
              id: Date.now(),
              text: 'Sample Text',
              font: 'Arial',
              size: 32,
              color: '#ffffff',
              x: canvas.width / 2,
              y: canvas.height / 2,
              rotation: 0,
              bold: false,
              underline: false,
              url: ''
            };
            selectLayer(0);
          } else {
            textLayers.splice(index, 1);
            if (selectedLayerIndex >= textLayers.length) {
              selectedLayerIndex = textLayers.length - 1;
            }
            selectLayer(selectedLayerIndex);
          }
          updateTextLayersList();
          renderAllText();
        }
        
        function updateTextLayersList() {
          if (!textLayersList) return;
          textLayersList.innerHTML = '';
          
          textLayers.forEach((layer, index) => {
            const item = document.createElement('div');
            item.style.cssText = 'display: flex; align-items: center; justify-content: space-between; padding: 8px; margin-bottom: 4px; background: ' + (index === selectedLayerIndex ? 'var(--accent)' : 'var(--bg)') + '; border: 1px solid var(--border); border-radius: 6px; cursor: pointer;';
            item.onclick = () => selectLayer(index);
            
            const text = document.createElement('span');
            text.textContent = layer.text || 'Empty';
            text.style.cssText = 'flex: 1; color: ' + (index === selectedLayerIndex ? '#001633' : 'var(--fg)') + '; font-size: 14px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;';
            
            const deleteBtn = document.createElement('button');
            deleteBtn.textContent = 'Ã—';
            deleteBtn.style.cssText = 'background: transparent; border: none; color: ' + (index === selectedLayerIndex ? '#001633' : 'var(--fg)') + '; font-size: 20px; cursor: pointer; padding: 0 8px; font-weight: bold;';
            deleteBtn.onclick = (e) => {
              e.stopPropagation();
              deleteLayer(index);
            };
            
            item.appendChild(text);
            item.appendChild(deleteBtn);
            textLayersList.appendChild(item);
          });
        }
        
        function startDrag(e) {
          // Check if clicking on rotation handle
          if (e.target === rotationHandle || rotationHandle.contains(e.target)) {
            startRotate(e);
            return;
          }
          
          if (selectedLayerIndex < 0 || selectedLayerIndex >= textLayers.length) return;
          e.preventDefault();
          e.stopPropagation();
          isDragging = true;
          
          const rect = canvas.getBoundingClientRect();
          const clientX = e.touches ? e.touches[0].clientX : e.clientX;
          const clientY = e.touches ? e.touches[0].clientY : e.clientY;
          
          const scaleX = canvas.width / rect.width;
          const scaleY = canvas.height / rect.height;
          const layer = textLayers[selectedLayerIndex];
          
          dragOffset.x = (clientX - rect.left) * scaleX - layer.x;
          dragOffset.y = (clientY - rect.top) * scaleY - layer.y;
          
          document.addEventListener('mousemove', drag);
          document.addEventListener('touchmove', drag);
          document.addEventListener('mouseup', stopDrag);
          document.addEventListener('touchend', stopDrag);
        }
        
        function drag(e) {
          if (!isDragging || selectedLayerIndex < 0 || selectedLayerIndex >= textLayers.length) return;
          e.preventDefault();
          
          const rect = canvas.getBoundingClientRect();
          const clientX = e.touches ? e.touches[0].clientX : e.clientX;
          const clientY = e.touches ? e.touches[0].clientY : e.clientY;
          
          // Calculate position relative to canvas, accounting for scaling
          const scaleX = canvas.width / rect.width;
          const scaleY = canvas.height / rect.height;
          const layer = textLayers[selectedLayerIndex];
          
          layer.x = (clientX - rect.left) * scaleX - dragOffset.x;
          layer.y = (clientY - rect.top) * scaleY - dragOffset.y;
          
          // Constrain to canvas bounds
          layer.x = Math.max(0, Math.min(canvas.width, layer.x));
          layer.y = Math.max(0, Math.min(canvas.height, layer.y));
          
          renderAllText();
        }
        
        function stopDrag() {
          isDragging = false;
          document.removeEventListener('mousemove', drag);
          document.removeEventListener('touchmove', drag);
          document.removeEventListener('mouseup', stopDrag);
          document.removeEventListener('touchend', stopDrag);
        }
        
        function startRotate(e) {
          if (selectedLayerIndex < 0 || selectedLayerIndex >= textLayers.length) return;
          e.preventDefault();
          e.stopPropagation();
          isRotating = true;
          
          document.addEventListener('mousemove', rotate);
          document.addEventListener('touchmove', rotate);
          document.addEventListener('mouseup', stopRotate);
          document.addEventListener('touchend', stopRotate);
        }
        
        function rotate(e) {
          if (!isRotating || selectedLayerIndex < 0 || selectedLayerIndex >= textLayers.length) return;
          e.preventDefault();
          
          const layer = textLayers[selectedLayerIndex];
          const canvasRect = canvas.getBoundingClientRect();
          const scaleX = canvas.width / canvasRect.width;
          const scaleY = canvas.height / canvasRect.height;
          
          const clientX = e.touches ? e.touches[0].clientX : e.clientX;
          const clientY = e.touches ? e.touches[0].clientY : e.clientY;
          
          // Convert mouse position to canvas coordinates
          const mouseX = (clientX - canvasRect.left) * scaleX;
          const mouseY = (clientY - canvasRect.top) * scaleY;
          
          // Calculate angle from text center to mouse position
          const dx = mouseX - layer.x;
          const dy = mouseY - layer.y;
          let angle = Math.atan2(dy, dx) * (180 / Math.PI);
          
          // Normalize to -180 to 180
          angle = angle % 360;
          if (angle > 180) angle -= 360;
          if (angle < -180) angle += 360;
          
          layer.rotation = angle;
          if (textRotation) textRotation.value = Math.round(angle);
          
          renderAllText();
        }
        
        function stopRotate() {
          isRotating = false;
          document.removeEventListener('mousemove', rotate);
          document.removeEventListener('touchmove', rotate);
          document.removeEventListener('mouseup', stopRotate);
          document.removeEventListener('touchend', stopRotate);
        }
        
        function downloadImage() {
          if (!imageObj) return;
          
          // Update selected layer one final time
          updateText();
          
          // Convert canvas to blob and download
          canvas.toBlob((blob) => {
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `text-overlay-${Date.now()}.png`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            // Track download
            if (typeof gtag === 'function') {
              gtag('event', 'download', {
                event_category: 'add_text_to_photo',
                event_label: 'text_overlay_download'
              });
            }
          }, 'image/png');
        }
        
        // Event listeners
        dropzone.addEventListener('click', () => fileInput.click());
        dropzone.addEventListener('dragover', (e) => {
          e.preventDefault();
          dropzone.style.borderColor = 'var(--accent)';
        });
        dropzone.addEventListener('dragleave', () => {
          dropzone.style.borderColor = 'var(--border)';
        });
        dropzone.addEventListener('drop', (e) => {
          e.preventDefault();
          dropzone.style.borderColor = 'var(--border)';
          const file = e.dataTransfer.files[0];
          if (file && file.type.startsWith('image/')) {
            loadImage(file);
          }
        });
        
        fileInput.addEventListener('change', (e) => {
          if (e.target.files[0]) {
            loadImage(e.target.files[0]);
          }
        });
        
        textInput.addEventListener('input', updateText);
        fontFamily.addEventListener('change', updateText);
        fontSize.addEventListener('input', updateText);
        textColor.addEventListener('change', updateText);
        textRotation.addEventListener('input', updateText);
        
        // Bold button toggle
        if (boldBtn) {
          boldBtn.addEventListener('click', () => {
            isBold = !isBold;
            boldBtn.classList.toggle('active', isBold);
            updateText();
          });
        }
        
        // Underline button toggle
        if (underlineBtn) {
          underlineBtn.addEventListener('click', () => {
            isUnderline = !isUnderline;
            underlineBtn.classList.toggle('active', isUnderline);
            updateText();
          });
        }
        
        if (emojiButton) {
          emojiButton.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            toggleEmojiPicker();
          });
        }
        
        // Close emoji picker when clicking outside
        document.addEventListener('click', (e) => {
          if (emojiPicker && emojiPicker.style.display !== 'none') {
            if (!emojiPicker.contains(e.target) && e.target !== emojiButton) {
              emojiPicker.style.display = 'none';
            }
          }
        });
        downloadBtn.addEventListener('click', downloadImage);
        resetBtn.addEventListener('click', () => {
          currentImage = null;
          imageObj = null;
          fileInput.value = '';
          editorSection.style.display = 'none';
          textLayers = [];
          selectedLayerIndex = -1;
          textInput.value = 'Sample Text';
          fontSize.value = 32;
          textColor.value = '#ffffff';
          textUrl.value = '';
          textRotation.value = 0;
          isBold = false;
          isUnderline = false;
          if (boldBtn) boldBtn.classList.remove('active');
          if (underlineBtn) underlineBtn.classList.remove('active');
          if (textLayersList) textLayersList.innerHTML = '';
        });
        
        // Make canvas clickable and draggable for text positioning
        canvas.addEventListener('mousedown', (e) => {
          if (!imageObj) return;
          startDrag(e);
        });
        
        canvas.addEventListener('touchstart', (e) => {
          if (!imageObj) return;
          startDrag(e);
        });
        
        // Make rotation handle draggable
        if (rotationHandle) {
          rotationHandle.addEventListener('mousedown', (e) => {
            e.preventDefault();
            e.stopPropagation();
            startRotate(e);
          });
          
          rotationHandle.addEventListener('touchstart', (e) => {
            e.preventDefault();
            e.stopPropagation();
            startRotate(e);
          });
        }
        
        // Also allow clicking to position selected text
        canvas.addEventListener('click', (e) => {
          if (!imageObj || isDragging || selectedLayerIndex < 0) return;
          
          const rect = canvas.getBoundingClientRect();
          const scaleX = canvas.width / rect.width;
          const scaleY = canvas.height / rect.height;
          const layer = textLayers[selectedLayerIndex];
          layer.x = (e.clientX - rect.left) * scaleX;
          layer.y = (e.clientY - rect.top) * scaleY;
          renderAllText();
        });
        
        // Add new text layer button
        if (addTextBtn) {
          addTextBtn.addEventListener('click', addNewTextLayer);
        }
        
        // Update text on window resize
        window.addEventListener('resize', () => {
          if (imageObj) {
            renderAllText();
          }
        });
        
        // Update rotation handle when rotation input changes
        if (textRotation) {
          textRotation.addEventListener('input', () => {
            if (selectedLayerIndex >= 0 && selectedLayerIndex < textLayers.length) {
              const layer = textLayers[selectedLayerIndex];
              layer.rotation = parseFloat(textRotation.value) || 0;
              renderAllText();
            }
          });
        }
      })();
    </script>
  </body>
</html>

