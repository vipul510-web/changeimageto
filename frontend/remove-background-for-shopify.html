<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Remove Background For Shopify | Free Online Tool</title>
    <meta name="description" content="Remove background for Shopify product photos with our free online tool. Create professional product images for your Shopify store. Fast processing, no watermark, perfect for ecommerce.">
    <meta name="keywords" content="free remove background from image, how to remove background from image, delete background from image, background remover, product, portrait">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://www.changeimageto.com/remove-background-for-shopify.html" />

    <meta property="og:title" content="Remove Background For Shopify | Free Online Tool" />
    <meta property="og:description" content="Remove background for Shopify product photos with our free online tool. Create professional product images for your Shopify store. Fast processing, no watermark, perfect for ecommerce." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.changeimageto.com/remove-background-for-shopify.html" />

    <script type="application/ld+json">
    {"@context":"https://schema.org","@type":"Service","name":"Free Background Remover","description":"Remove image backgrounds online using AI. Fast, free, and no login.","url":"https://www.changeimageto.com/remove-background-from-image.html","provider":{"@type":"Organization","name":"ChangeImageTo.com"},"offers":{"@type":"Offer","price":"0","priceCurrency":"USD"}}
    </script>

    <!-- DNS prefetch for external resources -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//fonts.gstatic.com">
    <link rel="dns-prefetch" href="//www.googletagmanager.com">
    
    <!-- Preconnect to critical external domains -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
    <noscript><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet"></noscript>
    
    <!-- Critical CSS for above-the-fold content -->
    <style>
      :root{--bg:#0b0f13;--fg:#eaf0f6;--muted:#9aa7b2;--accent:#6aa7ff;--card:#12171d;--border:#1e2630}
      *{box-sizing:border-box}
      body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;background:var(--bg);color:var(--fg);line-height:1.6}
      .container{max-width:1000px;margin:0 auto;padding:24px}
      .header h1{margin:0 0 8px}
      .header p{margin:0;color:var(--muted)}
      .logo-link{display:inline-flex;align-items:center;gap:10px;margin-bottom:10px;text-decoration:none;color:inherit}
      .logo-img{height:36px;width:auto;display:block}
      .top-nav a{color:#fff;text-decoration:none;font-weight:600}
      .top-nav a:hover{text-decoration:underline}
      .uploader{position:relative;border:2px dashed var(--border);border-radius:12px;padding:32px;display:flex;align-items:center;justify-content:center;cursor:pointer;background:var(--card)}
      .uploader input{position:absolute;inset:0;opacity:0;cursor:pointer;display:block;width:100%;height:100%}
      .uploader-instructions{display:flex;flex-direction:column;align-items:center;color:var(--muted)}
      .uploader.drag{border-color:var(--accent);background:#101826}
      button, .btn{background:var(--accent);color:#001633;border:none;padding:12px 16px;border-radius:10px;font-weight:700;cursor:pointer;text-decoration:none;display:inline-block}
      .btn.secondary{background:transparent;color:var(--fg);border:1px solid var(--border)}
      button[disabled]{opacity:.5;cursor:not-allowed}
      .preview{margin-top:24px}
      .preview-grid{display:grid;grid-template-columns:1fr;gap:16px}
      @media(min-width:900px){.preview-grid{grid-template-columns:1fr 1fr}}
      .checkerboard{background:conic-gradient(#cfd8e3 25%,transparent 0 50%,#cfd8e3 0 75%,transparent 0) 0 0/24px 24px; padding:12px;border-radius:12px}
      .preview img{width:100%;height:auto;border-radius:8px;display:block}
      .actions{margin-top:12px;display:flex;gap:12px;flex-wrap:wrap}
      .actions .btn{flex:1;min-width:120px}
      .actions a.btn{text-decoration:none;display:inline-block;text-align:center;cursor:pointer}
      .actions a.btn:hover{text-decoration:none}
      .seo{margin-top:40px;color:var(--muted)}
      .seo a{color:#fff;text-decoration:none}
      .seo a:hover{text-decoration:underline;color:var(--accent)}
      .footer{border-top:1px solid var(--border);margin-top:40px;color:var(--muted)}
      @media(max-width:768px){.container{padding:16px}.uploader{padding:24px}}
    </style>
    
    <!-- Preload critical resources immediately -->
    <link rel="preload" as="image" href="/logo.png?v=20250921-1">
    <link rel="preload" as="style" href="./styles.css?v=20250929-2">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" as="style">
    
    <!-- Load fonts with optimized technique -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
    <noscript><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet"></noscript>
    
    <!-- Critical CSS for above-the-fold content -->
    <style>
      :root{--bg:#0b0f13;--fg:#eaf0f6;--muted:#9aa7b2;--accent:#6aa7ff;--card:#12171d;--border:#1e2630}
      *{box-sizing:border-box}
      body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;background:var(--bg);color:var(--fg);line-height:1.6}
      .container{max-width:1000px;margin:0 auto;padding:24px}
      .header h1{margin:0 0 8px}
      .header p{margin:0;color:var(--muted)}
      .logo-link{display:inline-flex;align-items:center;gap:10px;margin-bottom:10px;text-decoration:none;color:inherit}
      .logo-img{height:36px;width:auto;display:block}
      .top-nav a{color:#fff;text-decoration:none;font-weight:600}
      .top-nav a:hover{text-decoration:underline}
      .uploader{position:relative;border:2px dashed var(--border);border-radius:12px;padding:32px;display:flex;align-items:center;justify-content:center;cursor:pointer;background:var(--card)}
      .uploader input{position:absolute;inset:0;opacity:0;cursor:pointer;display:block;width:100%;height:100%}
      .uploader-instructions{display:flex;flex-direction:column;align-items:center;color:var(--muted)}
      .uploader.drag{border-color:var(--accent);background:#101826}
      button, .btn{background:var(--accent);color:#001633;border:none;padding:12px 16px;border-radius:10px;font-weight:700;cursor:pointer;text-decoration:none;display:inline-block}
      .btn.secondary{background:transparent;color:var(--fg);border:1px solid var(--border)}
      button[disabled]{opacity:.5;cursor:not-allowed}
      .preview{margin-top:24px}
      .preview-grid{display:grid;grid-template-columns:1fr;gap:16px}
      @media(min-width:900px){.preview-grid{grid-template-columns:1fr 1fr}}
      .checkerboard{background:conic-gradient(#cfd8e3 25%,transparent 0 50%,#cfd8e3 0 75%,transparent 0) 0 0/24px 24px; padding:12px;border-radius:12px}
      .preview img{width:100%;height:auto;border-radius:8px;display:block}
      .actions{margin-top:12px;display:flex;gap:12px;flex-wrap:wrap}
      .actions .btn{flex:1;min-width:120px}
      .actions a.btn{text-decoration:none;display:inline-block;text-align:center;cursor:pointer}
      .actions a.btn:hover{text-decoration:none}
      .seo{margin-top:40px;color:var(--muted)}
      .seo a{color:#fff;text-decoration:none}
      .seo a:hover{text-decoration:underline;color:var(--accent)}
      .footer{border-top:1px solid var(--border);margin-top:40px;color:var(--muted)}
      @media(max-width:768px){.container{padding:16px}.uploader{padding:24px}}
    </style>
    
    <!-- Load main stylesheet asynchronously -->
    <link rel="stylesheet" href="./styles.css?v=20250929-2" media="print" onload="this.media='all'">
    <noscript><link rel="stylesheet" href="./styles.css?v=20250929-2"></noscript>
  
<!-- Google AI Overview tracking -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  if (window.location.hash.includes(":~:text")) {
    // Check if gtag is already available
    if (typeof gtag === "function") {
      gtag("event", "ai_overview", {
        anchor: window.location.hash
      });
    } else {
      // If gtag is not available yet, wait for it (for dynamic loading pattern)
      const checkGtag = setInterval(() => {
        if (typeof gtag === "function") {
          clearInterval(checkGtag);
          gtag("event", "ai_overview", {
            anchor: window.location.hash
          });
        }
      }, 100);
      // Stop checking after 10 seconds
      setTimeout(() => clearInterval(checkGtag), 10000);
    }
  }
});
</script>

<!-- Initialize dataLayer BEFORE GA loads (so early events are preserved) -->
<script>
  window.dataLayer = window.dataLayer || [];
</script>

<!-- Google tag (gtag.js) - Load asynchronously after page load -->
<script>
  // Load Google Analytics after page load to improve FCP
  window.addEventListener('load', function() {
    const script = document.createElement('script');
    script.async = true;
    script.src = 'https://www.googletagmanager.com/gtag/js?id=G-D3Q582VFCG';
    document.head.appendChild(script);
    
    script.onload = function() {
      // dataLayer already initialized above, just define gtag function
      function gtag(){dataLayer.push(arguments);}
      window.gtag = gtag; // Make it globally available
      gtag('js', new Date());
      gtag('config', 'G-D3Q582VFCG');
    };
  });
</script>

  </head>
  <body>
    <header class="container header">
      <a href="/" class="logo-link"><img src="./logo.png?v=20250921-1" alt="ChangeImageTo" class="logo-img" loading="eager" width="200" height="68" /></a>
      <div style="display:flex;align-items:center;gap:16px;justify-content:space-between;width:100%">
        <h1 style="margin:0">Remove Background For Shopify (Free)</h1>
        <nav class="top-nav"><a href="/blog" aria-label="Read our blog">Blog</a></nav>
      </div>
      <p>Upload a photo and remove background for shopify. Free, no login, no watermark.</p>
    </header>

    <main class="container main">
      <form id="upload-form">
        <div class="controls">
  <label>Photo Type</label>
  <div class="category-buttons" role="group" aria-label="Choose photo type">
    <button type="button" class="cat-btn active" data-cat="product" id="cat-product">Product / Object</button>
    <button type="button" class="cat-btn" data-cat="portrait" id="cat-portrait">Portrait / People</button>
  </div>
  <input type="hidden" id="category" name="category" value="product" />
</div>

        <div class="uploader" id="dropzone">
          <input type="file" id="file-input" accept="image/*" />
          <div class="uploader-instructions">
            <strong>Drop image here</strong>
            <span>or click to browse</span>
          </div>
        </div>

        <button id="process-btn" type="submit" disabled>Remove Background</button>
      </form>

      <section class="preview" id="preview-section" hidden>
        <div class="preview-grid">
          <div>
            <h3>Original</h3>
            <img id="original-img" alt="Original preview" />
          </div>
          <div>
            <h3>Background Removed</h3>
            <p id="process-prompt" class="prompt">Press "Remove Background" to process.</p>
            <div id="result-wrapper" hidden>
            <div class="checkerboard">
              <img id="result-img" alt="Result with transparent background" />
            </div>
            <div class="actions">
              <a id="download-link" download="bg-removed.png" class="btn">Download PNG</a>
              <button id="reset-btn" class="btn secondary" type="button">Try Another Image</button>
              <a href="/convert-image-format.html" class="btn secondary" id="to-converter" style="display:none">Change Image Format</a>
            </div>
          </div>
        </div>
      </section>

      <section class="seo">
        <h2>How to Remove Background For Shopify</h2>
        <p>Our free online tool makes it easy to remove background for shopifyfor Shopify listings. Simply upload your image above and click the process button. No signup required, no watermarks, completely free.</p>
        
        <h3>Why Remove Background For Shopify?</h3>
        <ul>

          <li><strong>Shopify Listings</strong>: Professional product photos with clean backgrounds are essential for Shopify success. Our tool helps you create consistent, high-quality images that stand out in search results and increase conversion rates.</li>
          <li><strong>Fast Processing</strong>: Process images in seconds, not minutes. Perfect for bulk editing Shopify product photos.</li>
          <li><strong>No Software Required</strong>: Works directly in your browser - no downloads, no installations, no subscriptions.</li>

        </ul>
        
        <h3>Step-by-Step Guide</h3>
        <ol>
          <li><strong>Upload Your Image</strong>: Click the upload area above or drag and drop your image file.</li>
          <li><strong>Select Photo Type</strong>: Choose "Product/Object" or "Portrait/People" for best results.</li>
          <li><strong>Process</strong>: Click the process button and wait a few seconds.</li>
          <li><strong>Download</strong>: Preview your result and download the processed image.</li>
        </ol>
        
        <h3>Tips for Best Results</h3>
        <ul>
          <li>Use high-resolution images (minimum 800x800 pixels)</li>
          <li>Ensure good contrast between subject and background</li>
          <li>For product photos, use consistent lighting</li>
          <li>Save as PNG format to preserve transparency</li>
        </ul>
        
        <h3>Frequently Asked Questions</h3>
        <div itemscope itemtype="https://schema.org/FAQPage">
          <div itemscope itemprop="mainEntity" itemtype="https://schema.org/Question">
            <h4 itemprop="name">Is this tool free to use?</h4>
            <div itemscope itemprop="acceptedAnswer" itemtype="https://schema.org/Answer">
              <p itemprop="text">Yes, our tool is completely free with no signup required and no watermarks.</p>
            </div>
          </div>
          <div itemscope itemprop="mainEntity" itemtype="https://schema.org/Question">
            <h4 itemprop="name">What image formats are supported?</h4>
            <div itemscope itemprop="acceptedAnswer" itemtype="https://schema.org/Answer">
              <p itemprop="text">We support JPG, PNG, and WebP formats for input. Output is always PNG format.</p>
            </div>
          </div>
          <div itemscope itemprop="mainEntity" itemtype="https://schema.org/Question">
            <h4 itemprop="name">How long does processing take?</h4>
            <div itemscope itemprop="acceptedAnswer" itemtype="https://schema.org/Answer">
              <p itemprop="text">Most images are processed in 2-5 seconds, depending on image size.</p>
            </div>
          </div>
        </div>
        
        <h3>Related Tools</h3>
        <ul>
          <li><a href="/remove-background-from-image.html">Remove Background from Image</a></li>
          <li><a href="/change-image-background.html">Change Image Background</a></li>
          <li><a href="/upscale-image.html">Upscale Image</a></li>
          <li><a href="/enhance-image.html">Enhance Image</a></li>
          <li><a href="/blur-background.html">Blur Background</a></li>
          <li><a href="/remove-text-from-image.html">Remove Text from Image</a></li>
          <li><a href="/remove-people-from-photo.html">Remove People from Photo</a></li>
          <li><a href="/change-color-of-image.html">Change Color of Image</a></li>
          <li><a href="/convert-image-format.html">Convert Image Format</a></li>
          <li><a href="/bulk-image-resizer.html">Bulk Image Resizer</a></li>
        </ul>
      </section>
    </main>

    
    <nav class="seo-links">
      <a href="/remove-background-from-image.html">Remove Background from Image</a>
      <a href="/change-color-of-image.html">Change color of image online</a>
      <a href="/change-image-background.html">Change image background</a>
      <a href="/convert-image-format.html">Convert image format</a>
      <a href="/upscale-image.html">AI Image Upscaler</a>
      <a href="/blur-background.html">Blur Background</a>
      <a href="/enhance-image.html">Enhance Image</a>
    </nav>

    <footer class="comprehensive-footer">
      <div class="container">
        <div class="footer-grid">
          <!-- Brand Section -->
          <div class="footer-brand">
            <div class="footer-logo">
              <img src="/logo.png?v=20250921-1" alt="ChangeImageTo" style="height: 32px; margin-bottom: 16px;">
            </div>
            <p class="footer-description">
              The leading platform for free online image editing. Remove backgrounds, change colors, resize images, and enhance photos instantly with AI-powered tools.
            </p>
            <div class="footer-social">
              <a href="https://x.com/vipulawl" aria-label="Follow us on Twitter" class="social-link">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                </svg>
              </a>
              <a href="https://www.youtube.com/@changeimageto" aria-label="Subscribe on YouTube" class="social-link">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
                </svg>
              </a>
              <a href="https://linkedin.com/company/make-a-video/" aria-label="Connect on LinkedIn" class="social-link">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                </svg>
              </a>
            </div>
          </div>

          <!-- Tools Section -->
          <div class="footer-section">
            <h3 class="footer-heading">Image Tools</h3>
            <ul class="footer-links">
              <li><a href="/remove-background-from-image.html">Remove Background</a></li>
              <li><a href="/change-image-background.html">Change Background</a></li>
              <li><a href="/change-color-of-image.html">Change Image Colors</a></li>
              <li><a href="/upscale-image.html">Upscale Image</a></li>
              <li><a href="/enhance-image.html">Enhance Image</a></li>
              <li><a href="/blur-background.html">Blur Background</a></li>
              <li><a href="/convert-image-format.html">Convert Image Format</a></li>
              <li><a href="/remove-people-from-photo.html">Remove People / Objects</a></li>
              <li><a href="/remove-text-from-image.html">Remove Text / Watermark</a></li>
              <li><a href="/bulk-image-resizer.html">Bulk Image Resizer</a></li>
              <li><a href="/image-quality-checker.html">Image Quality Checker</a></li>
              <li><a href="/real-estate-photo-enhancement.html">Real Estate Photo Enhancement</a></li>
            </ul>
          </div>

          <!-- Blog Section -->
          <div class="footer-section">
            <h3 class="footer-heading">Latest Blog Posts</h3>
            <ul class="footer-links">
              <li><a href="/blog/remove-background-from-image.html">Remove Background from Image</a></li>
              <li><a href="/blog/upscale-image.html">Upscale Image Quality</a></li>
              <li><a href="/blog/change-image-background-color.html">Change Image Background Color</a></li>
              <li><a href="/blog/remove-background-from-image-photoshop.html">Remove Background in Photoshop</a></li>
              <li><a href="/blog/change-image-background-color-online.html">Change Background Color Online</a></li>
              <li><a href="/blog/remove-background-from-image-canva.html">Remove Background in Canva</a></li>
              <li><a href="/blog/change-image-background-color-photoshop.html">Change Background in Photoshop</a></li>
              <li><a href="/blog/remove-background-from-image-android.html">Remove Background on Android</a></li>
            </ul>
          </div>

          <!-- Alternatives Section -->
          <div class="footer-section">
            <h3 class="footer-heading">Tool Alternatives</h3>
            <ul class="footer-links">
              <li><a href="/blog/photopea-vs-canva.html">Photopea vs Canva</a></li>
              <li><a href="/blog/capcut-vs-davinci-resolve.html">CapCut vs DaVinci Resolve</a></li>
              <li><a href="/blog/canva-vs-photopea.html">Canva vs Photopea</a></li>
              <li><a href="/blog/free-photoshop-alternatives.html">Free Photoshop Alternatives</a></li>
              <li><a href="/blog/ai-background-removers.html">AI Background Removers</a></li>
            </ul>
          </div>

          <!-- Company Section -->
          <div class="footer-section">
            <h3 class="footer-heading">Company</h3>
            <ul class="footer-links">
              <li><a href="/privacy-policy.html">Privacy Policy</a></li>
              <li><a href="/contact.html">Contact Us</a></li>
              <li><a href="/about.html">About</a></li>
            </ul>
          </div>
        </div>

        <!-- Bottom Bar -->
        <div class="footer-bottom">
          <div class="footer-bottom-content">
            <p class="footer-copyright">
              ¬© 2024 ChangeImageTo.com. All rights reserved. Built for speed and quality.
            </p>
            <div class="footer-bottom-links">
              <a href="/privacy-policy.html">Privacy</a>
              <a href="#terms">Terms</a>
              <a href="#cookies">Cookies</a>
              <a href="#security">Security</a>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <script>
      // ============================================
      // Feedback Popup System (same as main page)
      // ============================================
      (function() {
        'use strict';
        if (document.getElementById('feedback-popup')) return;
        const popup = document.createElement('div');
        popup.id = 'feedback-popup';
        popup.className = 'feedback-popup';
        popup.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;z-index:10000;display:none;align-items:center;justify-content:center;';
        popup.innerHTML = `<div class="feedback-popup-overlay" style="position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.6);backdrop-filter:blur(4px);"></div><div class="feedback-popup-content" style="position:relative;background:var(--card,#12171d);border:1px solid var(--border,#1e2630);border-radius:16px;padding:32px;max-width:500px;width:90%;max-height:90vh;overflow-y:auto;box-shadow:0 20px 60px rgba(0,0,0,0.3);z-index:1;"><button class="feedback-popup-close" id="feedback-close-btn" aria-label="Close feedback popup" style="position:absolute;top:16px;right:16px;background:transparent;border:none;color:var(--muted,#9aa7b2);font-size:28px;line-height:1;cursor:pointer;padding:4px 8px;border-radius:4px;transition:all 0.2s ease;">&times;</button><h3 class="feedback-popup-title" style="font-size:24px;font-weight:700;color:var(--fg,#eaf0f6);margin:0 0 8px;">How was your experience?</h3><p class="feedback-popup-subtitle" style="font-size:14px;color:var(--muted,#9aa7b2);margin:0 0 24px;">We'd love to hear your feedback!</p><div class="feedback-rating" style="margin:24px 0;text-align:center;"><div class="feedback-stars" style="display:flex;justify-content:center;gap:8px;margin-bottom:12px;"><button class="feedback-star" data-rating="1" aria-label="1 star" style="background:transparent;border:none;font-size:40px;cursor:pointer;padding:4px;transition:all 0.2s ease;filter:grayscale(100%) opacity(0.5);">‚≠ê</button><button class="feedback-star" data-rating="2" aria-label="2 stars" style="background:transparent;border:none;font-size:40px;cursor:pointer;padding:4px;transition:all 0.2s ease;filter:grayscale(100%) opacity(0.5);">‚≠ê</button><button class="feedback-star" data-rating="3" aria-label="3 stars" style="background:transparent;border:none;font-size:40px;cursor:pointer;padding:4px;transition:all 0.2s ease;filter:grayscale(100%) opacity(0.5);">‚≠ê</button><button class="feedback-star" data-rating="4" aria-label="4 stars" style="background:transparent;border:none;font-size:40px;cursor:pointer;padding:4px;transition:all 0.2s ease;filter:grayscale(100%) opacity(0.5);">‚≠ê</button><button class="feedback-star" data-rating="5" aria-label="5 stars" style="background:transparent;border:none;font-size:40px;cursor:pointer;padding:4px;transition:all 0.2s ease;filter:grayscale(100%) opacity(0.5);">‚≠ê</button></div><p class="feedback-rating-text" id="feedback-rating-text" style="font-size:14px;color:var(--muted,#9aa7b2);margin:0;">Tap a star to rate</p></div><div class="feedback-comment-section" style="margin:24px 0;"><label for="feedback-comment" class="feedback-comment-label" style="display:block;font-size:14px;font-weight:600;color:var(--fg,#eaf0f6);margin-bottom:8px;">Your feedback (optional)</label><textarea id="feedback-comment" class="feedback-comment-input" placeholder="Tell us what you think..." rows="4" maxlength="1000" style="width:100%;padding:12px;background:var(--bg,#0b0f13);border:1px solid var(--border,#1e2630);border-radius:8px;color:var(--fg,#eaf0f6);font-family:inherit;font-size:14px;resize:vertical;box-sizing:border-box;"></textarea><div class="feedback-char-count" style="font-size:12px;color:var(--muted,#9aa7b2);text-align:right;margin-top:4px;"><span id="feedback-char-count">0</span>/1000</div></div><div class="feedback-actions" style="display:flex;gap:12px;margin-top:24px;"><button class="feedback-btn feedback-btn-submit" id="feedback-submit-btn" disabled style="flex:1;padding:12px 24px;border:none;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer;transition:all 0.2s ease;background:var(--accent,#6aa7ff);color:#001633;opacity:0.5;">Submit Feedback</button><button class="feedback-btn feedback-btn-skip" id="feedback-skip-btn" style="flex:1;padding:12px 24px;border:1px solid var(--border,#1e2630);border-radius:8px;font-size:14px;font-weight:600;cursor:pointer;transition:all 0.2s ease;background:transparent;color:var(--muted,#9aa7b2);">Skip</button></div></div>`;
        document.body.appendChild(popup);
        let selectedRating = 0, hasShownFeedback = sessionStorage.getItem('feedbackShown') === 'true';
        function logImpression(action) {
          const apiBase = (['127.0.0.1','localhost'].includes(window.location.hostname) && window.location.port === '8080') ? 'http://127.0.0.1:8000' : 'https://bgremover-backend-121350814881.us-central1.run.app';
          fetch(apiBase + '/api/feedback/impression', {method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({page: window.location.pathname, operation: 'remove_background', action: action, userAgent: navigator.userAgent, timestamp: new Date().toISOString()})}).catch(() => {});
        }
        function showFeedbackPopup() {
          if (hasShownFeedback) return;
          const popupEl = document.getElementById('feedback-popup');
          if (!popupEl) return;
          logImpression('shown');
          selectedRating = 0;
          const commentEl = document.getElementById('feedback-comment');
          if (commentEl) commentEl.value = '';
          const charCountEl = document.getElementById('feedback-char-count');
          if (charCountEl) charCountEl.textContent = '0';
          const ratingTextEl = document.getElementById('feedback-rating-text');
          if (ratingTextEl) ratingTextEl.textContent = 'Tap a star to rate';
          const submitBtn = document.getElementById('feedback-submit-btn');
          if (submitBtn) submitBtn.disabled = true;
          document.querySelectorAll('.feedback-star').forEach(star => { star.classList.remove('active'); star.style.filter = 'grayscale(100%) opacity(0.5)'; });
          popupEl.style.display = 'flex';
          document.body.style.overflow = 'hidden';
        }
        function hideFeedbackPopup(action = 'closed') {
          const popupEl = document.getElementById('feedback-popup');
          if (popupEl) {
            if (action === 'closed' && !hasShownFeedback) logImpression('closed');
            popupEl.style.display = 'none';
            document.body.style.overflow = '';
          }
        }
        function submitFeedback() {
          if (selectedRating === 0) return;
          const commentEl = document.getElementById('feedback-comment');
          const apiBase = (['127.0.0.1','localhost'].includes(window.location.hostname) && window.location.port === '8080') ? 'http://127.0.0.1:8000' : 'https://bgremover-backend-121350814881.us-central1.run.app';
          fetch(apiBase + '/api/feedback', {method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({rating: selectedRating, comment: commentEl ? commentEl.value.trim() : '', page: window.location.pathname, operation: 'remove_background', timestamp: new Date().toISOString(), userAgent: navigator.userAgent})}).catch(() => {});
          logImpression('submitted');
          hasShownFeedback = true;
          sessionStorage.setItem('feedbackShown', 'true');
          hideFeedbackPopup('submitted');
          const thankYou = document.createElement('div');
          thankYou.style.cssText = 'position:fixed;top:20px;right:20px;background:var(--accent,#6aa7ff);color:#001633;padding:16px 24px;border-radius:8px;z-index:10001;font-weight:600;box-shadow:0 4px 12px rgba(0,0,0,0.2);';
          thankYou.textContent = 'Thank you for your feedback! üôè';
          document.body.appendChild(thankYou);
          setTimeout(() => { thankYou.style.opacity = '0'; thankYou.style.transition = 'opacity 0.3s'; setTimeout(() => thankYou.remove(), 300); }, 2000);
        }
        function initFeedbackPopup() {
          const popupEl = document.getElementById('feedback-popup');
          if (!popupEl) return;
          const closeBtn = document.getElementById('feedback-close-btn');
          if (closeBtn) { closeBtn.addEventListener('click', () => { logImpression('closed'); hideFeedbackPopup('closed'); }); }
          const overlay = popupEl.querySelector('.feedback-popup-overlay');
          if (overlay) overlay.addEventListener('click', () => { logImpression('closed'); hideFeedbackPopup('closed'); });
          document.querySelectorAll('.feedback-star').forEach(star => {
            star.addEventListener('click', function() {
              selectedRating = parseInt(this.dataset.rating);
              document.querySelectorAll('.feedback-star').forEach((s, index) => {
                if (index < selectedRating) { s.classList.add('active'); s.style.filter = 'grayscale(0%) opacity(1)'; } else { s.classList.remove('active'); s.style.filter = 'grayscale(100%) opacity(0.5)'; }
              });
              const ratingTexts = {1: 'Poor', 2: 'Fair', 3: 'Good', 4: 'Very Good', 5: 'Excellent'};
              const ratingTextEl = document.getElementById('feedback-rating-text');
              if (ratingTextEl) ratingTextEl.textContent = ratingTexts[selectedRating] || 'Tap a star to rate';
              const submitBtn = document.getElementById('feedback-submit-btn');
              if (submitBtn) { submitBtn.disabled = false; submitBtn.style.opacity = '1'; submitBtn.style.cursor = 'pointer'; }
            });
          });
          const submitBtn = document.getElementById('feedback-submit-btn');
          if (submitBtn) submitBtn.addEventListener('click', submitFeedback);
          const skipBtn = document.getElementById('feedback-skip-btn');
          if (skipBtn) skipBtn.addEventListener('click', () => { logImpression('skipped'); hasShownFeedback = true; sessionStorage.setItem('feedbackShown', 'true'); hideFeedbackPopup('skipped'); });
          document.addEventListener('keydown', function(e) { if (e.key === 'Escape' && popupEl.style.display !== 'none') { logImpression('closed'); hideFeedbackPopup('closed'); } });
        }
        if (document.readyState === 'loading') { document.addEventListener('DOMContentLoaded', initFeedbackPopup); } else { initFeedbackPopup(); }
        window.showFeedbackPopup = showFeedbackPopup;
      })();

      // Google Analytics event tracking function
      function trackGAEvent(eventName, eventParams) {
        window.dataLayer = window.dataLayer || [];
        const eventData = {
          'event': eventName,
          'event_category': eventParams.event_category || 'engagement',
          'event_label': eventParams.event_label || '',
          'value': eventParams.value || 1
        };
        if (eventParams.page_path) eventData.page_path = eventParams.page_path;
        if (eventParams.page_title) eventData.page_title = eventParams.page_title;
        window.dataLayer.push(eventData);
        if (typeof window.gtag === 'function') {
          try {
            window.gtag('event', eventName, eventParams);
          } catch (e) {
            console.warn('gtag call failed:', e);
          }
        }
      }

      // Use production endpoint - EXACT SAME AS WORKING PRODUCTION PAGE
      document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('upload-form');
        const fileInput = document.getElementById('file-input');
        const dropzone = document.getElementById('dropzone');
        const processBtn = document.getElementById('process-btn');
        const originalImg = document.getElementById('original-img');
        const resultImg = document.getElementById('result-img');
        const previewSection = document.getElementById('preview-section');
        const resultWrapper = document.getElementById('result-wrapper');
        const processPrompt = document.getElementById('process-prompt');
        const downloadLink = document.getElementById('download-link');
        const resetBtn = document.getElementById('reset-btn');
        const categoryInput = document.getElementById('category');
        let currentFile = null;

        // Category buttons
        document.querySelectorAll('.cat-btn').forEach(btn => {
          btn.addEventListener('click', function() {
            document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            categoryInput.value = this.dataset.cat;
          });
        });

        // File input handling
        fileInput.addEventListener('change', function(e) {
          if (e.target.files.length > 0) {
            currentFile = e.target.files[0];
            const reader = new FileReader();
            reader.onload = function(e) {
              originalImg.src = e.target.result;
              previewSection.hidden = false;
              processPrompt.style.display = 'block';
              resultWrapper.hidden = true;
            };
            reader.readAsDataURL(currentFile);
            processBtn.disabled = false;
          }
        });

        // Drag and drop
        dropzone.addEventListener('dragover', function(e) {
          e.preventDefault();
          dropzone.classList.add('drag');
        });
        dropzone.addEventListener('dragleave', function() {
          dropzone.classList.remove('drag');
        });
        dropzone.addEventListener('drop', function(e) {
          e.preventDefault();
          dropzone.classList.remove('drag');
          if (e.dataTransfer.files.length > 0) {
            fileInput.files = e.dataTransfer.files;
            fileInput.dispatchEvent(new Event('change'));
          }
        });

        // Form submission - use production endpoint /api/remove-bg (returns JSON with base64)
        form.addEventListener('submit', async function(e) {
          e.preventDefault();
          if (!currentFile) return;

          // Track CTA click in Google Analytics
          if (typeof trackGAEvent === 'function') {
            trackGAEvent('process_image_cta', {
              'event_category': 'engagement',
              'event_label': 'remove_background',
              'page_path': window.location.pathname,
              'page_title': document.title,
              'value': 1
            });
          }

          processBtn.disabled = true;
          processBtn.textContent = 'Processing‚Ä¶';

          const isLocal = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
          const API_BASE = isLocal ? 'http://127.0.0.1:8000' : 'https://bgremover-backend-121350814881.us-central1.run.app';

          const formData = new FormData();
          formData.append('file', currentFile);
          formData.append('category', categoryInput.value);

          try {
            const response = await fetch(`${API_BASE}/api/remove-bg`, {
              method: 'POST',
              body: formData,
            });

            const data = await response.json();

            if (data.error) {
              alert('Error: ' + data.error);
              processBtn.disabled = false;
              processBtn.textContent = 'Remove Background';
              return;
            }

            // Show result image - EXACT SAME AS WORKING PRODUCTION PAGE
            resultImg.src = data.test_image_base64;
            downloadLink.href = data.test_image_base64;
            downloadLink.download = `bg-removed-${Date.now()}.png`;

            processPrompt.style.display = 'none';
            resultWrapper.hidden = false;
            processBtn.disabled = false;
            processBtn.textContent = 'Remove Background';

            // Track download link creation
            if (typeof trackGAEvent === 'function') {
              trackGAEvent('download_image', {
                'event_category': 'engagement',
                'event_label': 'remove_background',
                'page_path': window.location.pathname,
                'page_title': document.title,
                'value': 1
              });
            }

            // Show feedback popup after successful processing (with delay for better UX)
            setTimeout(() => {
              if (typeof window.showFeedbackPopup === 'function') {
                window.showFeedbackPopup();
              }
            }, 2000);
          } catch (error) {
            alert('Error processing image: ' + error.message);
            processBtn.disabled = false;
            processBtn.textContent = 'Remove Background';
          }
        });

        // Reset button
        resetBtn.addEventListener('click', function() {
          currentFile = null;
          fileInput.value = '';
          originalImg.src = '';
          resultImg.src = '';
          downloadLink.removeAttribute('href');
          previewSection.hidden = true;
          processBtn.disabled = true;
        });

        // Download link tracking
        downloadLink.addEventListener('click', function() {
          if (typeof trackGAEvent === 'function') {
            trackGAEvent('download_image', {
              'event_category': 'engagement',
              'event_label': 'remove_background',
              'page_path': window.location.pathname,
              'page_title': document.title,
              'value': 1
            });
          }
        });
      });
    </script>
  </body>
</html>
